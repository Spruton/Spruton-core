!function(i){i.fn.chosenClassPrefix=function(){return i(this).is('[class^="chzn-"]')?"chzn":"chosen"},i.fn.chosenOrder=function(){var s=this.filter("."+this.chosenClassPrefix()+"-sortable[multiple]").first(),e=s.siblings("."+this.chosenClassPrefix()+"-container");return i(e.find("."+this.chosenClassPrefix()+'-choices li[class!="search-field"]').map(function(){text=i(this).html(),text=text.replace(/<b class="group-name">(.*)<\/b>/,"").replace(/<\/?[^>]+(>|$)/g,"");var e=!1;return s.find("option:contains("+text+")").each(function(){$(this).html()==text&&(e=this)}),this?e:void 0}))},i.fn.chosenSortable=function(){this.filter("."+this.chosenClassPrefix()+"-sortable[multiple]").each(function(){chosen_order=i(this).attr("chosen_order")?i(this).attr("chosen_order").split(","):new Array,i(this).setSelectionOrder(chosen_order);var s=i(this),e=s.siblings("."+s.chosenClassPrefix()+"-container");i.ui?(e.find("."+s.chosenClassPrefix()+"-choices").bind("mousedown",function(e){i(e.target).is("span")&&e.stopPropagation()}),e.find("."+s.chosenClassPrefix()+"-choices").sortable({placeholder:"search-choice-placeholder",items:"li:not(.search-field)",tolerance:"pointer",start:function(e,s){s.placeholder.width(s.item.innerWidth()),s.placeholder.height(s.item.innerHeight())}}),s.closest("form")&&s.closest("form").bind("submit",function(){var e=s.chosenOrder();s.children().remove(),s.append(e)})):console.error("jquery-chosen-sortable requires JQuery UI to have been initialised.")})}}(jQuery);